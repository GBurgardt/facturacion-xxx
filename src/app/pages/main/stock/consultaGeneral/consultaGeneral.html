<ba-card cardTitle="Filtros" class="consulta-general" toggleBtn="true">

    <div class="block-column">
        <div class="input-row">
            <div class="item-input">
                <label  for="desde">
                    Producto *
                </label>
                <input  [(ngModel)]="filtros.codProducto"
                        type="text"
                        class="form-control text-right"
                        id="inputProducto"
                        placeholder=""
                        (keydown.arrowdown)="keyPressInputTextoProd($event)('down')"
                        (keydown.arrowup)="keyPressInputTextoProd($event)('up')"
                        (keyup.enter)="onEnterInputProd($event)"
                        (ngModelChange)="onChangeInputProd($event)"
                        (blur)="onBlurInputProd($event)"
                        >

                <popup-lista    *ngIf="filtros.codProducto && filtros.codProducto.length > 0"
                                [items]="productos.filtrados.asObservable().distinctUntilChanged()"
                                [keysToShow]="['descripcion', 'codProducto']"
                                [onClickItem]="onSelectProducto"
                                [fatherPosition]="popupListaService.getOffsetOfInputCliente('inputProducto')">
                </popup-lista>

            </div>

            <div class="item-input">
                <label  for="hasta">
                    Hasta *
                </label>
                <input  [(ngModel)]="filtros.codProducto2"
                        type="text"
                        class="form-control text-right"
                        id="inputProducto2"
                        placeholder=""
                        (keydown.arrowdown)="keyPressInputTextoProd2($event)('down')"
                        (keydown.arrowup)="keyPressInputTextoProd2($event)('up')"
                        (keyup.enter)="onEnterInputProd2($event)"
                        (ngModelChange)="onChangeInputProd2($event)"
                        (blur)="onBlurInputProd2($event)"
                        >

                <popup-lista    *ngIf="filtros.codProducto2 && filtros.codProducto2.length > 0"
                                [items]="productos2.filtrados.asObservable().distinctUntilChanged()"
                                [keysToShow]="['descripcion', 'codProducto']"
                                [onClickItem]="onSelectProducto2"
                                [fatherPosition]="popupListaService.getOffsetOfInputCliente('inputProducto2')">
                </popup-lista>

            </div>

        </div>

        <div class="input-row">
            <div class="item-select">
                <label for="selectRubro">
                    Rubro
                </label>
                <select [(ngModel)]="filtros.rubro" (ngModelChange)="onChangeRubro($event)" class="form-control" id="selectRubro">
                    <option [ngValue]="null">
                        Todos
                    </option>
                    <option *ngFor="let rub of rubros | async" [ngValue]="rub">
                        {{rub.descripcion}}
                    </option>
                </select>
            </div>
            <div class="item-select">
                <label for="selectSubRubro">
                    Sub Rubro
                </label>
                <select [(ngModel)]="filtros.subRubro" class="form-control" id="selectSubRubro">
                    <option [ngValue]="null">
                        Todos
                    </option>
                    <option *ngFor="let subrub of subRubros | async" [ngValue]="subrub">
                        {{subrub.descripcion}}
                    </option>
                </select>
            </div>
        </div>
    </div>



    <div class="block-column">

        <div class="input-row">
            <div class="item-input nro-cte">
                <label for="desde" [ngStyle]="{'min-width': '117px', 'margin-top': '7px'}">
                    Fecha Hasta *
                </label>

                <div class="input-group date-picker-venc-hasta">
                    <input [(ngModel)]="filtros.fechaHasta" (blur)="onBlurFechaHasta($event)" class="form-control" placeholder="dd/mm/aaaa" name="dp" ngbDatepicker #dDesd="ngbDatepicker">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" (click)="dDesd.toggle()" type="button" style="height: 100%;">
                            <img src="assets/img/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;" />
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="input-row flex-end">
            <div class="item-input nro-cte">
                <button id="btnConsultar"
                    [disabled]="!filtros.codProducto || !filtros.codProducto2 || !filtros.fechaHasta"
                    (click)="onClickConsultar()"
                    class="btn btn-primary">
                    <i class="fa fa-search" aria-hidden="true"></i>
                    Consultar
                </button>
            </div>
        </div>
    </div>
</ba-card>

<ba-card>
    <table class="table table-striped" [mfData]="stockData | async" #mf="mfDataTable" mfRowsOnPage="10">
        <thead>
            <tr>
                <th>Codigo</th>
                <th>Descripcion</th>
                <!-- <th class="text-right">Pendiente</th> -->
                <th class="text-right">Ingresos</th>
                <th class="text-right">Egresos</th>
                <th class="text-right">Stock</th>
                <th class="text-right">Ingresos Virtual</th>
                <th class="text-right">Egresos Virtual</th>
                <th class="text-right">Imputado Virtual</th>
                <th class="text-right">Stock Virtual</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let stockElement of mf.data">
                <td>{{ stockElement.codProducto }}</td>
                <td>{{ stockElement.descripcion }}</td>
                <!-- <td class="text-right">{{ stockElement.pendiente }}</td> -->
                <td class="text-right">{{ stockElement.ingresos }}</td>
                <td class="text-right">{{ stockElement.egresos }}</td>
                <td class="text-right">{{ stockElement.stockFisico }}</td>
                <td class="text-right">{{ stockElement.ingresoVirtual }}</td>
                <td class="text-right">{{ stockElement.egresoVirtual }}</td>
                <td class="text-right">{{ stockElement.virtualImputado }}</td>
                <td class="text-right">{{ stockElement.stockVirtual }}</td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="12">
                    <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                </td>
            </tr>
        </tfoot>
    </table>


</ba-card>
