<ba-card cardTitle="Filtros" class="consulta-por-producto" toggleBtn="true">

    <div class="block-column">
        <div class="input-row">
            <div class="item-input nro-cte">
                <label  for="desde">
                    Producto
                </label>
                <input  [(ngModel)]="filtros.codProducto"
                        type="text" 
                        class="form-control text-right" 
                        id="inputProducto" 
                        placeholder=""
                        (keydown.arrowdown)="keyPressInputTextoProd($event)('down')" 
                        (keydown.arrowup)="keyPressInputTextoProd($event)('up')"
                        (keyup.enter)="onEnterInputProd($event)" 
                        (ngModelChange)="onChangeInputProd($event)" 
                        (blur)="onBlurInputProd($event)"
                        >

                <popup-lista    *ngIf="filtros.codProducto && filtros.codProducto.length > 0" 
                                [items]="productos.filtrados.asObservable().distinctUntilChanged()" 
                                [keysToShow]="['descripcion', 'codProducto']" 
                                [onClickItem]="onSelectProducto"
                                [fatherPosition]="popupListaService.getOffsetOfInputCliente('inputProducto')">
                </popup-lista>

                <input  disabled
                        [(ngModel)]="info.nombreProd"
                        type="text" 
                        class="form-control text-right" 
                        id="inputInfoProd" 
                        placeholder="">
            </div>
        </div>
    
        <div class="input-row">
            <div class="item-select">
                <label for="selectComprobante">
                    Comprobante
                </label>
                <select [(ngModel)]="filtros.cteTipo" class="form-control" id="selectComprobante">
                    <option *ngFor="let tipoCte of cteTipos | async" [ngValue]="tipoCte">
                        {{tipoCte.descCorta}}
                    </option>
                </select>
            </div>
        </div>
    </div>

    <div class="block-column">

        <!-- <div class="input-row">
            <div class="item-input">
                <input  [(ngModel)]="info.nombreProd"
                        type="text" 
                        class="form-control text-right" 
                        id="inputInfoProd" 
                        placeholder="">
            </div>
        </div> -->

        <div class="input-row">
            <div class="item-select">
                <label for="selectComprobante">
                    Deposito
                </label>
                <select [(ngModel)]="filtros.deposito" class="form-control" id="selectDeposito">
                    <option *ngFor="let dep of depositos | async" [ngValue]="dep">
                        {{dep.descripcion}}
                    </option>
                </select>
            </div>
        </div>
    </div>

    <div class="block-column">
        
        <div class="input-row">
            <div class="item-input nro-cte">
                <label for="desde" [ngStyle]="{'min-width': '117px', 'margin-top': '7px'}">
                    Fecha Hasta
                </label>

                <div class="input-group date-picker-venc-hasta">
                    <input [(ngModel)]="filtros.fechaHasta" (blur)="onBlurFechaHasta($event)" class="form-control" placeholder="dd/mm/aaaa" name="dp" ngbDatepicker #dDesd="ngbDatepicker">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" (click)="dDesd.toggle()" type="button" style="height: 100%;">
                            <img src="assets/img/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;" />
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="input-row flex-end">
            <div class="item-input nro-cte">
                <button id="btnConsultar"  
                    [disabled]="false" 
                    (click)="onClickConsultar()" 
                    class="btn btn-primary">
                    <i class="fa fa-search" aria-hidden="true"></i>
                    Consultar
                </button>
            </div>
        </div>
    </div>
</ba-card>

<ba-card>
    <table class="table table-striped" [mfData]="stockData | async" #mf="mfDataTable" mfRowsOnPage="10">
        <thead>
            <tr>
                <th>Lote</th>
                <th class="td-right">Serie</th>
                <th class="td-right">Cod</th>
                <th>Producto</th>
                <th>Vto</th>
                <th class="td-right">Ingresos</th>
                <th class="td-right">Egresos</th>
                <th class="td-right">Stock</th>
                <th>Tipo</th>
                <th class="td-right">Nro Comp</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let lote of mf.data">
                <td>{{ lote.nroLote }}</td>
                <td class="td-right">{{ lote.serie }}</td>
                <td class="td-right">{{ lote.codProducto }}</td>
                <td class="td-nowrap">{{ lote.descripcionProd }}</td>
                <td>{{ utilsService.formatearFecha('DD/MM/YYYY')(lote.fechaVto) }}</td>
                <td class="td-right">{{ lote.ingresos }}</td>
                <td class="td-right">{{ lote.egresos }}</td>
                <td class="td-right">{{ lote.stock }}</td>
                <td>{{ lote.comprobante }}</td>
                <td class="td-right">{{ lote.numero }}</td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="12">
                    <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                </td>
            </tr>
        </tfoot>
    </table>
</ba-card>